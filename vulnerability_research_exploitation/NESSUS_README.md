# Nessus Vulnerability Scanning - Complete Guide

## Table of Contents
- [Introduction](#introduction)
- [Learning Objectives](#learning-objectives)
- [Fundamentals of Vulnerability Management](#fundamentals-of-vulnerability-management)
- [Task 0: Using Nessus to Scan a Website for Vulnerabilities](#task-0-using-nessus-to-scan-a-website-for-vulnerabilities)

---

## Introduction

This guide covers the fundamentals of vulnerability management using Nessus, one of the most widely used vulnerability scanning tools in cybersecurity. You will learn how to install, configure, and use Nessus to identify security weaknesses in web applications and systems.

---

## Learning Objectives

After completing this guide, you will be able to:

| Objective | Description |
|-----------|-------------|
| **Vulnerability Management Fundamentals** | Understand the lifecycle of identifying, assessing, and remediating vulnerabilities |
| **Role of Vulnerability Scanning** | Explain how scanning fits into overall security management |
| **Nessus Installation** | Install Nessus on Windows, Linux, and macOS |
| **Nessus Configuration** | Configure Nessus for optimal scanning performance |
| **UI Navigation** | Navigate dashboard, menus, and settings |
| **Scan Management** | Create, schedule, and manage vulnerability scans |
| **Policies & Templates** | Configure and customize scan policies |
| **Results Analysis** | Interpret scan findings and severity levels |
| **Reporting** | Generate comprehensive vulnerability reports |
| **Remediation** | Prioritize and address vulnerabilities effectively |

---

## Fundamentals of Vulnerability Management

### What is Vulnerability Management?

Vulnerability management is a continuous process of identifying, evaluating, treating, and reporting security vulnerabilities in systems and software.

### The Vulnerability Management Lifecycle

```
┌─────────────────────────────────────────────────────────────────┐
│                 VULNERABILITY MANAGEMENT CYCLE                   │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│    ┌──────────┐    ┌──────────┐    ┌──────────┐    ┌──────────┐ │
│    │ DISCOVER │ → │ PRIORITIZE│ → │ REMEDIATE│ → │  VERIFY  │ │
│    └──────────┘    └──────────┘    └──────────┘    └──────────┘ │
│         ↑                                               │       │
│         └───────────────────────────────────────────────┘       │
│                         CONTINUOUS                               │
└─────────────────────────────────────────────────────────────────┘
```

### Role of Vulnerability Scanning

| Phase | Role of Scanning |
|-------|------------------|
| **Discovery** | Automated identification of vulnerabilities across assets |
| **Assessment** | Provides severity scores and context for prioritization |
| **Validation** | Confirms successful remediation through rescanning |
| **Compliance** | Demonstrates due diligence for regulatory requirements |

---

## Nessus Installation

### System Requirements

| Component | Minimum | Recommended |
|-----------|---------|-------------|
| **RAM** | 4 GB | 8 GB+ |
| **CPU** | 2 cores | 4+ cores |
| **Disk** | 30 GB | 50 GB+ SSD |
| **OS** | Windows 10/Server 2016, Ubuntu 18.04+, macOS 10.14+ | Latest versions |

### Installation Steps

#### Linux (Debian/Ubuntu)
```bash
# Download Nessus package
curl -o Nessus.deb https://www.tenable.com/downloads/api/v1/public/pages/nessus/downloads/xxxxx/download?i_agree_to_tenable_license_agreement=true

# Install
sudo dpkg -i Nessus.deb

# Start service
sudo systemctl start nessusd
sudo systemctl enable nessusd

# Access via browser
# https://localhost:8834
```

#### Windows
1. Download installer from [Tenable Downloads](https://www.tenable.com/downloads/nessus)
2. Run `.msi` installer as Administrator
3. Follow installation wizard
4. Access `https://localhost:8834`

#### macOS
```bash
# Download .dmg from Tenable
# Mount and install
sudo /Library/Nessus/run/sbin/nessusd start
# Access https://localhost:8834
```

### Initial Configuration

1. **Create Account**: Set up admin username and password
2. **Choose License**: Select Nessus Essentials (free) or enter activation code
3. **Register**: Provide email for activation code
4. **Plugin Download**: Wait for plugins to download and compile

---

## Nessus Configuration for Optimal Performance

### Performance Settings

| Setting | Recommendation | Purpose |
|---------|----------------|---------|
| **Max Simultaneous Hosts** | 10-20 | Balance speed vs. network impact |
| **Max Simultaneous Checks per Host** | 4-5 | Prevent target overload |
| **Network Timeout** | 5 seconds | Handle slow responses |
| **Scan Delay** | 0-2 ms | Reduce network congestion |

### Network Considerations

```
┌─────────────────────────────────────────────────────────┐
│              OPTIMAL SCAN CONFIGURATION                  │
├─────────────────────────────────────────────────────────┤
│                                                          │
│  Scanner Location:                                       │
│  • Internal scans: Deploy scanner inside network        │
│  • External scans: Use cloud-based or DMZ scanner       │
│                                                          │
│  Credentials:                                            │
│  • Enable credentialed scans for deeper analysis        │
│  • Use service accounts with read-only access           │
│                                                          │
│  Scheduling:                                             │
│  • Run during off-peak hours                            │
│  • Stagger scans for large networks                     │
│                                                          │
└─────────────────────────────────────────────────────────┘
```

---

## Navigating Nessus User Interface

### Dashboard Overview

```
┌─────────────────────────────────────────────────────────────────┐
│  NESSUS DASHBOARD                                    [User] ▼   │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐            │
│  │  Scans  │  │ Assets  │  │Policies │  │ Reports │            │
│  └─────────┘  └─────────┘  └─────────┘  └─────────┘            │
│                                                                  │
│  ┌──────────────────────────────────────────────────────────┐   │
│  │  Recent Scans                                             │   │
│  ├──────────────────────────────────────────────────────────┤   │
│  │  Scan Name          Status      Vulnerabilities           │   │
│  │  ──────────────────────────────────────────────────────  │   │
│  │  Web App Scan       Completed   C:5  H:12  M:28  L:45    │   │
│  │  Network Scan       Running     ████████░░ 80%           │   │
│  └──────────────────────────────────────────────────────────┘   │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

### Key Menu Items

| Menu | Function |
|------|----------|
| **Scans** | Create, manage, and view scan results |
| **Settings** | Configure scanner, accounts, and plugins |
| **Policies** | Create and manage scan policies |
| **Plugin Rules** | Customize plugin behavior |

---

## Task 0: Using Nessus to Scan a Website for Vulnerabilities

### Objective
Use Nessus Essentials to configure and run a vulnerability scan on an authorized target website and analyze the results.

### Target Selection
For this exercise, I selected **hackaday.com** as the target website.

> ⚠️ **Important**: Only scan websites you have explicit permission to test. Unauthorized scanning is illegal.

---

### 1. Scan Configuration

#### Why Web Application Tests Template?

I chose the **Web Application Tests** template for the following reasons:

| Reason | Explanation |
|--------|-------------|
| **Specialized Testing** | Designed specifically for web application vulnerabilities |
| **Comprehensive Coverage** | Tests for OWASP Top 10 vulnerabilities |
| **Application-Layer Focus** | Scans HTTP/HTTPS services, forms, and dynamic content |
| **Reduced False Positives** | Optimized plugins for web technologies |
| **Crawling Capabilities** | Automatically discovers web pages and endpoints |

#### Configuration Considerations

**General Settings**:
- **Scan Name**: "Hackaday Web Application Scan"
- **Description**: "Vulnerability assessment of hackaday.com"
- **Targets**: `hackaday.com`

**Discovery Settings**:
```
┌─────────────────────────────────────────────────────────┐
│  DISCOVERY CONFIGURATION                                 │
├─────────────────────────────────────────────────────────┤
│  Host Discovery:           [✓] Ping Remote Host         │
│  Port Scanning:            [✓] Common Ports             │
│  Service Discovery:        [✓] Probe Services           │
│                                                          │
│  Web Application Settings:                               │
│  ├─ Start URL:            https://hackaday.com          │
│  ├─ Max Pages to Crawl:   1000                          │
│  ├─ Max Depth:            6                             │
│  └─ Follow Dynamic Pages: [✓] Enabled                   │
└─────────────────────────────────────────────────────────┘
```

**Assessment Settings**:
- **Accuracy**: Balanced (avoid DoS-type checks)
- **Web App Tests**: Enabled all non-destructive tests
- **CGI Scanning**: Enabled for legacy applications

**Advanced Settings**:
- **Safe Checks**: Enabled (prevent service disruption)
- **Silent Dependencies**: Enabled
- **Rate Limiting**: Configured to avoid overwhelming target

---

### 2. Scan Execution

#### Launching the Scan

**Step-by-step Process**:

1. **Navigate to Scans**
   - Click "Scans" in the left navigation menu
   - Click "New Scan" button (top right)

2. **Select Template**
   - Choose "Web Application Tests" from scanner templates
   - Click to configure

3. **Configure Settings**
   - Enter target URL: `hackaday.com`
   - Set scan name and description
   - Review and adjust settings as needed

4. **Launch**
   - Click "Save" to save configuration
   - Click "Launch" (play button) to start scan

```
┌─────────────────────────────────────────────────────────┐
│  SCAN LAUNCH CONFIRMATION                                │
├─────────────────────────────────────────────────────────┤
│                                                          │
│  Scan: Hackaday Web Application Scan                    │
│  Target: hackaday.com                                   │
│  Template: Web Application Tests                        │
│                                                          │
│  [  Cancel  ]                    [  Launch  ]           │
│                                                          │
└─────────────────────────────────────────────────────────┘
```

#### Monitoring Scan Progress

**Monitoring Methods**:

| Method | Description |
|--------|-------------|
| **Progress Bar** | Visual indication of completion percentage |
| **Status Column** | Shows Running/Completed/Paused/Cancelled |
| **Live Results** | Click on running scan to see real-time findings |
| **Host Details** | View individual host scan progress |

**Progress Indicators**:
```
┌─────────────────────────────────────────────────────────┐
│  SCAN PROGRESS                                           │
├─────────────────────────────────────────────────────────┤
│                                                          │
│  Hackaday Web Application Scan                          │
│  ═══════════════════════════════════░░░░░░░░░░  65%     │
│                                                          │
│  Hosts Scanned: 1/1                                     │
│  Plugins Run: 4,523/6,892                               │
│  Vulnerabilities Found: 47                              │
│  Time Elapsed: 00:45:23                                 │
│  Estimated Remaining: 00:25:00                          │
│                                                          │
└─────────────────────────────────────────────────────────┘
```

**Ensuring Smooth Execution**:
- Monitored network bandwidth usage
- Checked for scan errors or connection issues
- Verified target remained accessible throughout
- Reviewed partial results for accuracy

---

### 3. Results Analysis

#### Vulnerability Summary

**[SCREENSHOT PLACEHOLDER: Nessus Scan Results Dashboard]**

```
┌─────────────────────────────────────────────────────────────────┐
│  SCAN RESULTS: Hackaday Web Application Scan                    │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  Total Vulnerabilities Found: 87                                │
│                                                                  │
│  ┌─────────────────────────────────────────────────────────┐    │
│  │  CRITICAL  │  HIGH  │  MEDIUM  │  LOW  │  INFO          │    │
│  │     2      │   8    │    23    │  19   │   35           │    │
│  │    ███     │  ███   │   ███    │  ███  │   ███          │    │
│  └─────────────────────────────────────────────────────────┘    │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

#### Critical and High-Severity Vulnerabilities Summary

| Severity | Plugin ID | Vulnerability | CVSS | Count |
|----------|-----------|---------------|------|-------|
| **Critical** | 104743 | SSL/TLS Vulnerability | 9.8 | 1 |
| **Critical** | 97861 | Outdated CMS Version | 9.1 | 1 |
| **High** | 51192 | Missing Security Headers | 7.5 | 2 |
| **High** | 34460 | Cross-Site Scripting (XSS) | 7.4 | 3 |
| **High** | 44135 | Cookie Without Secure Flag | 7.1 | 2 |
| **High** | 42873 | Information Disclosure | 7.0 | 1 |

#### Detailed Vulnerability Analysis

**Selected Vulnerability: Missing HTTP Security Headers**

```
┌─────────────────────────────────────────────────────────────────┐
│  VULNERABILITY DETAILS                                          │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  Name: Missing HTTP Security Headers                            │
│  Severity: HIGH                                                 │
│  CVSS Score: 7.5                                                │
│  Plugin ID: 51192                                               │
│  Plugin Family: Web Servers                                     │
│                                                                  │
│  ─────────────────────────────────────────────────────────────  │
│                                                                  │
│  DESCRIPTION:                                                   │
│  The remote web server does not implement several important     │
│  HTTP security headers that help protect against common         │
│  web application attacks.                                       │
│                                                                  │
│  Missing Headers Detected:                                      │
│  • X-Content-Type-Options                                       │
│  • X-Frame-Options                                              │
│  • Content-Security-Policy                                      │
│  • Strict-Transport-Security                                    │
│                                                                  │
│  ─────────────────────────────────────────────────────────────  │
│                                                                  │
│  POTENTIAL IMPACT:                                              │
│  • Clickjacking attacks via iframe embedding                    │
│  • MIME-type sniffing attacks                                   │
│  • Cross-site scripting (XSS) attacks                          │
│  • Man-in-the-middle attacks on non-HTTPS connections          │
│                                                                  │
│  ─────────────────────────────────────────────────────────────  │
│                                                                  │
│  REMEDIATION STEPS:                                             │
│                                                                  │
│  1. Add the following headers to your web server config:        │
│                                                                  │
│     X-Content-Type-Options: nosniff                             │
│     X-Frame-Options: DENY                                       │
│     Content-Security-Policy: default-src 'self'                 │
│     Strict-Transport-Security: max-age=31536000                 │
│                                                                  │
│  2. For Apache (.htaccess):                                     │
│     Header always set X-Content-Type-Options "nosniff"          │
│     Header always set X-Frame-Options "DENY"                    │
│                                                                  │
│  3. For Nginx (nginx.conf):                                     │
│     add_header X-Content-Type-Options "nosniff";                │
│     add_header X-Frame-Options "DENY";                          │
│                                                                  │
│  4. Test implementation using security header scanners          │
│                                                                  │
│  ─────────────────────────────────────────────────────────────  │
│                                                                  │
│  REFERENCES:                                                    │
│  • OWASP Secure Headers Project                                 │
│  • CWE-693: Protection Mechanism Failure                        │
│  • Mozilla Web Security Guidelines                              │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

---

### 4. Vulnerability Severity Assessment

#### Understanding Severity Levels

| Level | CVSS Range | Description | Response Time |
|-------|------------|-------------|---------------|
| **Critical** | 9.0 - 10.0 | Immediate exploitation risk, full system compromise possible | 24-48 hours |
| **High** | 7.0 - 8.9 | Significant risk, may lead to data breach or system access | 1 week |
| **Medium** | 4.0 - 6.9 | Moderate risk, requires specific conditions to exploit | 30 days |
| **Low** | 0.1 - 3.9 | Limited risk, minimal impact | 90 days |
| **Info** | 0.0 | Informational findings, no direct security impact | As needed |

#### Vulnerability Types Identified

```
┌─────────────────────────────────────────────────────────────────┐
│  VULNERABILITY CATEGORIES                                        │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  Configuration Issues          ████████████████░░░░  35%        │
│  Missing Security Controls     ██████████████░░░░░░  28%        │
│  Outdated Software             ████████░░░░░░░░░░░░  18%        │
│  Information Disclosure        ██████░░░░░░░░░░░░░░  12%        │
│  Injection Vulnerabilities     ███░░░░░░░░░░░░░░░░░   7%        │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

---

### 5. Report Generation

#### Generating Nessus Report

**Steps**:
1. Select completed scan from Scans list
2. Click "Export" button (top right)
3. Choose report format:
   - **PDF**: Executive summaries and presentations
   - **HTML**: Interactive web-based reports
   - **CSV**: Data analysis and integration
   - **Nessus**: Native format for re-import

**Report Configuration**:
```
┌─────────────────────────────────────────────────────────┐
│  EXPORT REPORT                                           │
├─────────────────────────────────────────────────────────┤
│                                                          │
│  Format:        [PDF ▼]                                 │
│                                                          │
│  Report Type:                                            │
│  ○ Executive Summary                                    │
│  ● Complete List of Vulnerabilities                     │
│  ○ Custom                                               │
│                                                          │
│  Include:                                                │
│  [✓] Vulnerability Descriptions                         │
│  [✓] Remediation Steps                                  │
│  [✓] Plugin Output                                      │
│  [✓] Risk Scores                                        │
│                                                          │
│  [  Cancel  ]                    [  Export  ]           │
│                                                          │
└─────────────────────────────────────────────────────────┘
```

---

### 6. Prioritization and Remediation

#### Remediation Priority Matrix

| Priority | Vulnerabilities | Action Required |
|----------|-----------------|-----------------|
| **P1 - Immediate** | Critical: SSL/TLS, Outdated CMS | Patch within 24-48 hours, consider taking offline if needed |
| **P2 - Urgent** | High: XSS, Missing Headers, Cookie Security | Schedule patches for next maintenance window |
| **P3 - Planned** | Medium: Information disclosure, Configuration issues | Include in next sprint/release cycle |
| **P4 - Monitor** | Low & Info: Minor configurations | Track and address during routine maintenance |

#### Remediation Workflow

```
┌─────────────────────────────────────────────────────────────────┐
│                    REMEDIATION PROCESS                          │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  1. TRIAGE                                                      │
│     └─→ Review all findings                                     │
│     └─→ Validate true positives                                 │
│     └─→ Assign severity based on context                        │
│                                                                  │
│  2. PLAN                                                        │
│     └─→ Create remediation tickets                              │
│     └─→ Assign owners                                           │
│     └─→ Set deadlines based on severity                         │
│                                                                  │
│  3. REMEDIATE                                                   │
│     └─→ Apply patches/fixes                                     │
│     └─→ Implement compensating controls                         │
│     └─→ Document changes                                        │
│                                                                  │
│  4. VERIFY                                                      │
│     └─→ Rescan to confirm fixes                                 │
│     └─→ Close remediation tickets                               │
│     └─→ Update security documentation                           │
│                                                                  │
│  5. REPORT                                                      │
│     └─→ Generate final report                                   │
│     └─→ Present metrics to stakeholders                         │
│     └─→ Plan next assessment cycle                              │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

---

## Conclusion

This exercise demonstrated the practical application of Nessus in identifying and managing web application vulnerabilities. Key takeaways include:

1. **Proper Configuration**: Template selection and settings significantly impact scan quality
2. **Monitoring**: Active monitoring ensures scan completion and accuracy
3. **Analysis**: Understanding severity helps prioritize remediation efforts
4. **Reporting**: Clear reports facilitate communication with stakeholders
5. **Remediation**: Structured approach ensures vulnerabilities are properly addressed

---

## References

- [Nessus Documentation](https://docs.tenable.com/nessus/)
- [Nessus Community Forums](https://community.tenable.com/)
- [OWASP Testing Guide](https://owasp.org/www-project-web-security-testing-guide/)
- [CVSS v3.1 Specification](https://www.first.org/cvss/specification-document)
- [CWE - Common Weakness Enumeration](https://cwe.mitre.org/)
